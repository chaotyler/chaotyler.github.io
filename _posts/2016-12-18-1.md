---
layout: page
title: 关于IIFE、函数声明、函数表达式、箭头函数
---

#### IIFE

直接开题：

    (function() {
      // ...
    })();

这是一个最基本的IIFE（Immidiately Invoked Function Expression），这实际上是对JS函数作用域的一个应用，通过一个匿名function将作用域进行隔离，避免被污染。

我们将这个IIFE拆解一下，来看下为什么IIFE要这么写：

#### 函数声明

    function() {
      //...
    }

JS中以function开头的是一个函数声明，但是上面的代码会报错，因为JS语法中要求，一个函数声明必须有函数名，也就是必须如下：

    function fn() {
      //...
    }

这里的fn就是函数名，这段代码会声明一个name为fn的函数，并非匿名函数。

说到这里，可能有人说，既然声明好了，那直接调用就行了，如下：

    function fn() {
      //...
    }()

这段代码同样会报错，因为JS语法中规定，一个函数声明是无法被立即调用的，只能通过函数名调用。

1. 函数声明不能匿名，也就是必须有name。
2. 函数声明不能被立即调用。

#### 函数表达式

函数声明不能匿名，不能立即调用，那么怎样才可以呢？答案是将函数声明转换为函数表达式（Expression），要将一个函数声明转换为函数表达式有很多方法，一般是通过某个操作符，比如：()、+、-、~等，最常用的还是文章开始我们用的分组操作费()。


    (function() {
      //...
    })

ok，这样，一个函数声明就转换成了函数表达式，函数表达式是可以匿名、可以被立即调用的，最后将这个函数表达式加上方法的调用()就可以了。


    (function() {
      //...
    })();

这样就构成了一个IIFE，其实IIFE不必须是匿名，指定一个方法名也可以，而且如果报错，调试时能在函数调用栈里面可能更清晰。但是为了简略，一般情况下都是使用匿名函数。

与函数声明不同：

1. 函数表达式可以匿名。
2. 函数表达式可以被立即调用。


#### 箭头函数

ES6中引入了箭头函数，箭头函数同样能用来实现IIFE：

    (() => {
      //...
    })();

但是不同于function，箭头函数无法给定一个name，所以即使直接用箭头声明一个函数，也可以：

    () => {
      //...
    }

所以箭头函数：

1. 箭头函数声明无法指定name，必须匿名。
2. 同样不可以立即调用，如果要立即调用，必须转换成函数表达式。
